import{_ as y,c as S,a as E,o as l,b as u,d as n,w as d,V as P,F as k,e as q,f,g as C,h,i as g,j as p,k as o,l as _,m as R,n as O,p as B,q as F,r as b,s as N,t as I,u as T,v as j,x as V,y as U,z as D,A as Q,B as H,C as M,D as z,E as K,G,H as x,O as w,I as L,J as A}from"./main-c1366cb5.js";import{b as J,e as W,t as X,v as Y}from"./filtersData-36fe0b62.js";import{C as Z,i as $}from"./CarsAreaCard-70f28ef2.js";const ee={name:"filters-area",props:{brands:{type:Array,required:!0},carNamesList:{type:Array,required:!0},propFiltered:{type:Boolean,required:!0}},data(){return{model:null,filters:{body:null,brand:null,engine:null,transmission:null,volume:null},sendOpportunity:!0,bodys:J,engines:W,transmissions:X,volumes:Y,filtered:!1}},computed:{isBrandFiltered(){return!!(this.filters.brand&&(this.filtered||this.propFiltered))},brandRouteQuery(){const e=this.$route.query.brandId,s=this.brands;if(e&&s.length){const a=s.find(c=>c.id===e);if(a)return{id:e,name:a.name}}return{id:e,name:null,routeName:this.$route.name}},isFiltersEmpty(){return S(this.filters)},isFiltersEmptyExceptBrand(){return E(this.filters)&&this.filters.brand}},watch:{brandRouteQuery:{immediate:!0,handler(){this.filters.brand=this.brandRouteQuery.name,this.brandRouteQuery.id?this.$emit("loadCars",this.brandRouteQuery.id):this.brandRouteQuery.routeName==="Home"&&this.reset()},deep:!0},filters:{immediate:!1,handler(){this.isFiltersEmpty&&this.search()},deep:!0},model(){this.loadCar()}},created(){const e=this.$route.query.brandId;e&&(this.filtered=!0,this.$emit("loadCars",e))},methods:{search(){this.sendOpportunity&&(this.startSendTimer(),this.isFiltersEmptyExceptBrand?(this.filtered=!0,this.$emit("filterBrands",this.filters.brand)):this.isFiltersEmpty||(this.filtered=!0,this.$emit("filterCars",this.filters)))},loadCarNamesList(e){this.sendOpportunity&&(this.startSendTimer(),this.$emit("loadCarNamesList",e))},loadCar(){this.model!==null&&this.model!==void 0&&this.model>0&&this.$router.push({path:"/car",query:{id:this.model}})},startSendTimer(){this.sendOpportunity=!1,setTimeout(()=>{this.sendOpportunity=!0},500)},resetFilter(e){this.filters[e]=null,this.search()},resetFilters(){this.filtered=!1,Object.keys(this.filters).forEach(s=>{this.filters[s]=null})},async reset(){this.resetFilters(),await this.$router.push("/"),this.$emit("reset")}}},se=e=>(B("data-v-892765f5"),e=e(),F(),e),te={class:"filters"},re=se(()=>f("h4",null,"Фильтры",-1)),ae={class:"filter"},ie={class:"filter"},ne={class:"filter"},le={class:"filter"};function de(e,s,a,c,r,t){return l(),u("aside",te,[re,n(O,{onSubmit:R(t.search,["prevent"])},{default:d(()=>[n(P,{modelValue:r.filters.brand,"onUpdate:modelValue":s[0]||(s[0]=i=>r.filters.brand=i),modelModifiers:{trim:!0},disabled:t.isBrandFiltered,label:"Бренд"},null,8,["modelValue","disabled"]),t.isBrandFiltered?(l(),u(k,{key:0},[n(q,{modelValue:r.model,"onUpdate:modelValue":s[1]||(s[1]=i=>r.model=i),clearable:!0,items:a.carNamesList,label:"Модель",onKeyup:s[2]||(s[2]=i=>t.loadCarNamesList(i.target.value)),"onClick:clear":s[3]||(s[3]=i=>t.loadCarNamesList(""))},null,8,["modelValue","items"]),f("div",ae,[n(C,{modelValue:r.filters.volume,"onUpdate:modelValue":s[4]||(s[4]=i=>r.filters.volume=i),items:r.volumes,label:"Объем двигателя","persistent-hint":"","return-object":""},null,8,["modelValue","items"]),r.filters.volume?(l(),h(p,{key:0,icon:"",text:"",onClick:s[5]||(s[5]=i=>t.resetFilter("volume"))},{default:d(()=>[n(g,{icon:"mdi-delete"})]),_:1})):o("",!0)]),f("div",ie,[n(C,{modelValue:r.filters.transmission,"onUpdate:modelValue":s[6]||(s[6]=i=>r.filters.transmission=i),items:r.transmissions,label:"Трансмиссия","persistent-hint":"","return-object":""},null,8,["modelValue","items"]),r.filters.transmission?(l(),h(p,{key:0,icon:"",text:"",onClick:s[7]||(s[7]=i=>t.resetFilter("transmission"))},{default:d(()=>[n(g,{icon:"mdi-delete"})]),_:1})):o("",!0)]),f("div",ne,[n(C,{modelValue:r.filters.engine,"onUpdate:modelValue":s[8]||(s[8]=i=>r.filters.engine=i),items:r.engines,label:"Двигатель","persistent-hint":"","return-object":""},null,8,["modelValue","items"]),r.filters.engine?(l(),h(p,{key:0,icon:"",text:"",onClick:s[9]||(s[9]=i=>t.resetFilter("engine"))},{default:d(()=>[n(g,{icon:"mdi-delete"})]),_:1})):o("",!0)]),f("div",le,[n(C,{modelValue:r.filters.body,"onUpdate:modelValue":s[10]||(s[10]=i=>r.filters.body=i),items:r.bodys,label:"Корпус","persistent-hint":"","return-object":""},null,8,["modelValue","items"]),r.filters.body?(l(),h(p,{key:0,icon:"",text:"",onClick:s[11]||(s[11]=i=>t.resetFilter("body"))},{default:d(()=>[n(g,{icon:"mdi-delete"})]),_:1})):o("",!0)])],64)):o("",!0),n(p,{disabled:t.isFiltersEmpty,elevation:"1",type:"action"},{default:d(()=>[_(" Искать ")]),_:1},8,["disabled"]),t.isFiltersEmpty?o("",!0):(l(),h(p,{key:1,class:"mr-4",elevation:"2",onClick:t.reset},{default:d(()=>[_(" Сбросить ")]),_:1},8,["onClick"]))]),_:1},8,["onSubmit"])])}const oe=y(ee,[["render",de],["__scopeId","data-v-892765f5"]]);const ue={name:"cars-area",components:{CarsAreaCard:Z},props:{cars:{type:Array,required:!0},carPages:{type:Number,required:!0}},data(){return{model:0,page:1}},computed:{pages(){const e=[];let s=[];return this.cars.forEach(a=>{s.length<9?s.push(a):(e.push(s),s=[])}),this.cars.length<9&&!e.length&&s.length&&(e.push(s),s=[]),e},pagesAmount(){return this.carPages>=0?this.carPages-1:this.pages.length}},watch:{page(){this.carPages>=0&&this.$emit("setPage",this.page)}}},ce=e=>(B("data-v-a78f8fe6"),e=e(),F(),e),me={class:"cars"},he=ce(()=>f("h4",null,"Машины",-1)),pe={key:0},fe={key:1,class:"wrap"};function _e(e,s,a,c,r,t){const i=b("cars-area-card");return l(),u("div",me,[he,t.pages.length?o("",!0):(l(),u("span",pe,"Пусто")),t.pages.length?(l(),u("div",fe,[(l(!0),u(k,null,N(t.pages[a.carPages>=0?0:r.page-1],(m,v)=>(l(),h(i,{key:m.id+v,car:m},null,8,["car"]))),128))])):o("",!0),t.pagesAmount>1?(l(),h(I,{key:2,modelValue:r.page,"onUpdate:modelValue":s[0]||(s[0]=m=>r.page=m),length:t.pagesAmount,"total-visible":5,circle:""},null,8,["modelValue","length"])):o("",!0)])}const ge=y(ue,[["render",_e],["__scopeId","data-v-a78f8fe6"]]);const be={name:"brand-card",props:{brand:{type:Object,required:!0}},data:()=>({show:!1,image:$}),computed:{description(){return this.brand.description!=="-"?this.brand.description:"Описание отсутствует"}},methods:{open(){const e={brandId:this.$props.brand.id};this.$router.push({path:"/",query:e}),this.$emit("loadCars",this.$props.brand.id)},swapDescription(){this.show=!this.show}}},ye={class:"brand"};function Ce(e,s,a,c,r,t){return l(),u("div",ye,[n(G,{style:{paddingTop:"40px"},class:"mx-auto","min-width":"240px",width:"100%"},{default:d(()=>[n(T,{"lazy-src":e.image,src:a.brand.image,style:{marginBottom:"20px"},contain:"",height:"64px"},null,8,["lazy-src","src"]),n(j,null,{default:d(()=>[_(V(a.brand.name),1)]),_:1}),n(U,null,{default:d(()=>[n(p,{class:"open",color:"orange lighten-2",text:"",onClick:t.open},{default:d(()=>[_(" МОДЕЛИ ")]),_:1},8,["onClick"]),n(D),n(p,{icon:"",onClick:t.swapDescription},{default:d(()=>[n(g,null,{default:d(()=>[_(V(e.show?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:1})]),_:1},8,["onClick"])]),_:1}),n(Q,null,{default:d(()=>[H(f("div",null,[n(M),n(z,null,{default:d(()=>[_(V(t.description),1)]),_:1})],512),[[K,e.show]])]),_:1})]),_:1})])}const ve=y(be,[["render",Ce],["__scopeId","data-v-f3707500"]]);const Ve={name:"brands-area",components:{BrandsAreaCard:ve},props:{brands:{type:Array,required:!0}},data(){return{model:0,page:1}},computed:{pages(){const e=[];let s=[],a=this.brands;return a.forEach(c=>{s.length<9?s.push(c):(e.push(s),s=[])}),a.length<9&&!e.length&&s.length&&(e.push(s),s=[]),e}},methods:{loadCars(e){this.$emit("loadCars",e)}}},ke=e=>(B("data-v-9d691362"),e=e(),F(),e),Be={class:"brands"},Fe=ke(()=>f("h4",null,"Бренды",-1)),xe={key:0},we={key:1,class:"wrap"};function Le(e,s,a,c,r,t){const i=b("brands-area-card");return l(),u("div",Be,[Fe,t.pages.length?o("",!0):(l(),u("span",xe,"Пусто")),t.pages.length?(l(),u("div",we,[(l(!0),u(k,null,N(t.pages[r.page-1],m=>(l(),h(i,{key:m.id,brand:m,onLoadCars:t.loadCars},null,8,["brand","onLoadCars"]))),128))])):o("",!0),t.pages.length>1?(l(),h(I,{key:2,modelValue:r.page,"onUpdate:modelValue":s[0]||(s[0]=m=>r.page=m),length:t.pages.length,"total-visible":5,circle:""},null,8,["modelValue","length"])):o("",!0)])}const Ae=y(Ve,[["render",Le],["__scopeId","data-v-9d691362"]]);const Ne={name:"home-view",components:{FiltersArea:oe,CarsArea:ge,BrandsArea:Ae},data(){return{brands:[],filteredBrands:[],cars:[],filteredCars:[],carPage:-1,carNamesList:[],filtered:!1}},computed:{brandsShowing(){return this.filteredCars?!this.filtered:!0}},mounted(){this.loadBrands()},methods:{setBrands(e){this.filteredBrands=e},setCars(e){this.filteredCars=e},reset(){this.cars=this.filteredCars=[],this.filteredBrands=this.brands,this.filtered=!1},setCarPage(e){this.carPage=e},setCarNamesList(e){e.length&&(e=e.map(s=>({text:s.model,value:s.id}))),this.carNamesList=e},async loadBrands(){const e=x(A,"cars","brands"),s=await w(e);if(s.exists()){const a=s.data().brands;this.brands=a,this.setBrands(a),L("loadBrands")}},filterBrands(e=""){this.setBrands(this.brands.filter(s=>s.name.startsWith(e))),this.setCars(this.cars)},async loadCars(e){const s=x(A,"cars","models"),a=await w(s);if(a.exists()){const r=a.data()[e];this.cars=r,this.setCars(r),this.setCarPage(-1),this.filtered=!0,L("loadCars")}},loadCarNamesList(e){},filterCars(e){const s=Object.keys(e),a=this.cars.filter(c=>{let r=!0;return s.forEach(t=>{e[t]!==null&&t!=="brand"&&c[t]!==e[t]&&(r=!1)}),r});this.setCars(a)}}},Ie={class:"home"};function Se(e,s,a,c,r,t){const i=b("filters-area"),m=b("brands-area"),v=b("cars-area");return l(),u("div",Ie,[n(i,{brands:r.brands,"car-names-list":r.carNamesList,propFiltered:r.filtered,onFilterBrands:t.filterBrands,onFilterCars:t.filterCars,onLoadCarNamesList:t.loadCarNamesList,onLoadCars:t.loadCars,onReset:t.reset},null,8,["brands","car-names-list","propFiltered","onFilterBrands","onFilterCars","onLoadCarNamesList","onLoadCars","onReset"]),t.brandsShowing?(l(),h(m,{key:"brand",brands:r.filteredBrands,onLoadCars:t.loadCars},null,8,["brands","onLoadCars"])):(l(),h(v,{key:"cars","car-pages":r.carPage,cars:r.filteredCars,onSetPage:t.setCarPage},null,8,["car-pages","cars","onSetPage"]))])}const Re=y(Ne,[["render",Se],["__scopeId","data-v-61f96b64"]]);export{Re as default};
